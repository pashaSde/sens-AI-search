{"version":3,"sources":["components/Search.tsx","App.tsx","index.js"],"names":["backendUrl","process","Search","imageFile","setImageFile","useState","imageMatches","setImageMatches","textQuery","setTextQuery","textMatches","setTextMatches","loading","setLoading","imageOod","setImageOod","textOod","setTextOod","_jsxs","children","className","_jsx","onSubmit","async","e","preventDefault","_data$query_ood_score","formData","FormData","append","res","fetch","concat","method","body","headers","mode","data","json","results","query_ood_score","err","alert","type","accept","onChange","_e$target$files","target","files","disabled","style","margin","toFixed","map","match","idx","border","borderRadius","marginBottom","padding","path","src","alt","caption","maxWidth","maxHeight","rank","ood_score","_data$query_ood_score2","JSON","stringify","query","value","placeholder","App","Router","position","zIndex","role","Routes","Route","element","ReactDOM","render","React","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.b9cd4046.chunk.js","sourcesContent":["import React, { useState } from 'react';\n\nconst backendUrl = process.env.REACT_APP_BACKEND_URL;\n\n// Helper to map OOD score to a green-red color (lower = greener, higher = redder)\nfunction oodColor(score: number, min: number, max: number) {\n  // Flip: low OOD = green, high OOD = red\n  const norm = 1 - Math.max(0, Math.min(1, (score - min) / (max - min)));\n  const r = Math.round(255 * (1 - norm));\n  const g = Math.round(180 * norm + 75 * (1 - norm));\n  return `rgba(${r},${g},120,0.15)`;\n}\n\nconst Search: React.FC = () => {\n  const [imageFile, setImageFile] = useState<File | null>(null);\n  const [imageMatches, setImageMatches] = useState<any[]>([]);\n  const [textQuery, setTextQuery] = useState('');\n  const [textMatches, setTextMatches] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [imageOod, setImageOod] = useState<number | null>(null);\n  const [textOod, setTextOod] = useState<number | null>(null);\n\n  // For demo, set min/max OOD for color mapping (adjust as needed)\n  const OOD_MIN = 0;\n  const OOD_MAX = 20;\n\n  const handleImageUpload = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!imageFile) return;\n    setLoading(true);\n    try {\n      const formData = new FormData();\n      formData.append('image', imageFile);\n      const res = await fetch(`${backendUrl}/search_by_image`, {\n        method: 'POST',\n        body: formData,\n        headers: { 'ngrok-skip-browser-warning': 'true' }, // Skip ngrok warning if using ngrok\n        mode: \"cors\"\n      });\n      const data = await res.json();\n      setImageMatches(data.results || []);\n      setImageOod(data.query_ood_score ?? null);\n    } catch (err) {\n      alert('Image search failed.');\n    }\n    setLoading(false);\n  };\n\n  const handleTextSearch = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n    try {\n      const res = await fetch(`${backendUrl}/search_by_text`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json', 'ngrok-skip-browser-warning': 'true'},\n        body: JSON.stringify({ query: textQuery }),\n        mode: \"cors\"\n      });\n      const data = await res.json();\n      setTextMatches(data.results || []);\n      setTextOod(data.query_ood_score ?? null);\n    } catch (err) {\n      alert('Text search failed.');\n    }\n    setLoading(false);\n  };\n\n  return (\n    <div>\n      <div className=\"sensei-card\">\n        <h2>Search by Image</h2>\n        <form onSubmit={handleImageUpload}>\n          <input\n            type=\"file\"\n            accept=\"image/*\"\n            onChange={e => setImageFile(e.target.files?.[0] || null)}\n          />\n          <button className=\"sensei-btn\" type=\"submit\" disabled={loading}>Upload & Search</button>\n        </form>\n        {imageOod !== null && (\n          <div style={{margin: '1em 0'}}>\n            <strong>Query OOD Score:</strong> {imageOod.toFixed(2)}\n          </div>\n        )}\n        <div>\n          {imageMatches.map((match, idx) => (\n            <div\n              key={idx}\n              className=\"result\"\n              style={{\n                border: '1px solid #ccc',\n                borderRadius: '8px',\n                marginBottom: '1em',\n                padding: '1em'\n              }}\n            >\n              {match.path && (\n                <img\n                  src={backendUrl + match.path}\n                  alt={match.caption}\n                  style={{ maxWidth: 400, maxHeight: 400, borderRadius: 12, marginBottom: '0.5em' }}\n                />\n              )}\n              <div>Rank: {match.rank}</div>\n              <div>Caption: {match.caption}</div>\n              <div>\n                <strong>OOD Score:</strong> {match.ood_score.toFixed(2)}\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      <div className=\"sensei-card\">\n        <h2>Search by Text</h2>\n        <form onSubmit={handleTextSearch}>\n          <input\n            type=\"text\"\n            value={textQuery}\n            onChange={e => setTextQuery(e.target.value)}\n            placeholder=\"Enter your query...\"\n          />\n          <button className=\"sensei-btn\" type=\"submit\" disabled={loading}>Search</button>\n        </form>\n        {textOod !== null && (\n          <div style={{margin: '1em 0'}}>\n            <strong>Query OOD Score:</strong> {textOod.toFixed(2)}\n          </div>\n        )}\n        <div>\n          {textMatches.map((match, idx) => (\n            <div\n              key={idx}\n              className=\"result\"\n              style={{\n                border: '1px solid #ccc',\n                borderRadius: '8px',\n                marginBottom: '1em',\n                padding: '1em'\n              }}\n            >\n              {match.path && (\n                <img\n                  src={backendUrl + match.path}\n                  alt={match.caption}\n                  style={{ maxWidth: 400, maxHeight: 400, borderRadius: 12, marginBottom: '0.5em' }}\n                />\n              )}\n              <div>Rank: {match.rank}</div>\n              <div>Caption: {match.caption}</div>\n              <div>\n                <strong>OOD Score:</strong> {match.ood_score.toFixed(2)}\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Search;","import React from 'react';\nimport { BrowserRouter as Router, Route, Routes } from 'react-router-dom';\nimport Search from './components/Search';\nimport './sensei-theme.css';\n\nconst App: React.FC = () => {\n    return (\n        <Router>\n            <div className=\"sensei-splash-bg\"></div>\n            <div className=\"sensei-splash-overlay\"></div>\n            <div style={{ position: 'relative', zIndex: 2 }}>\n                <header className=\"sensei-header\">\n                    <span role=\"img\" aria-label=\"ninja\">ðŸ¥·</span> Sens-AI-Search\n                    <div className=\"sensei-subheader\">\n                        Find images by text or upload, powered by AI <span role=\"img\" aria-label=\"spark\">âœ¨</span>\n                    </div>\n                </header>\n                <Routes>\n                    <Route path=\"/\" element={<Search />} />\n                </Routes>\n                 <Routes>\n                    <Route path=\"/sens-AI-search\" element={<Search />} />\n                </Routes>\n            </div>\n        </Router>\n    );\n};\n\nexport default App;","// filepath: /Users/pankajsharma/PycharmProjects/SenseiSearch/image-retrieval-ui/src/index.js\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n//\n// const root = ReactDOM.createRoot(document.getElementById('root'));\n// root.render(\n//   <React.StrictMode>\n//     <App />\n//   </React.StrictMode>\n// );\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}